<% case @station.state %>
<% when 4 %>
  $(".home_screen").hide();
  $(".menu_screen").show();
  $(".main_menu").show();
  $(".dsc_routine_call").hide();
  $(".dsc_emergency_call").hide();

  $("#menu1").click(function(){
    $(".main_menu").hide();
    $(".dsc_routine_call").show();
    $(".link:visible").eq(0).focus();
  });
  $("#menu1").keypress(function(e){
    if(e.which == 13){
      $("#menu1").click();
    }
  });

  $("#menu2").click(function(){
    $(".main_menu").hide();
    $(".dsc_emergency_call").show();
    $(".link:visible").eq(0).focus();
  });
  $("#menu2").keypress(function(e){
    if(e.which == 13){
      $("#menu2").click();
    }
  });

  $(".link:visible").eq(0).focus();

  $(window).on('keydown', function(e) {
    if(e.keyCode === 38) { // ↑
        focus_prev();
        return false;
    }
    if(e.keyCode === 40) { // ↓
        focus_next();
        return false;
    }
  });
  function focus_prev() {
      var currentFocusIndex = $('.link').index($(':focus'));

      if(currentFocusIndex > -1) {
          for (var i = 0; i < $('.link').length; i++) {
              if(i === currentFocusIndex && i > 0) {
                  $('.link').eq(i - 1).focus();
                }
              }
            }
          }
  function focus_next() {
    var currentFocusIndex = $('.link').index($(':focus'));

    if(currentFocusIndex > -1) {
      for (var i = 0; i < $('.link').length; i++) {
        if(i === currentFocusIndex && i < $('.link').length - 1) {
          $('.link').eq(i + 1).focus();
        }
      }
    } else {
      $('.link').eq(0).focus();
    }
  }
<% else %>
<% end %>
