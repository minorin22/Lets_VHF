<% case @station.state %>
<% when 3 %>
  $(".sub_screen").css("display","block").show();
  $(".link").last().focus();

  $(window).on('keydown', function(e) {
    if(e.keyCode === 37) { // ↑
        focus_prev();
        return false;
    }
    if(e.keyCode === 39) { // ↓
        focus_next();
        return false;
    }
  });
  function focus_prev() {
      var currentFocusIndex = $('.link').index($(':focus'));

      if(currentFocusIndex > -1) {
          for (var i = 0; i < $('.link').length; i++) {
              if(i === currentFocusIndex && i > 0) {
                  $('.link').eq(i - 1).focus();
                }
              }
            }
          }
  function focus_next() {
    var currentFocusIndex = $('.link').index($(':focus'));

    if(currentFocusIndex > -1) {
      for (var i = 0; i < $('.link').length; i++) {
        if(i === currentFocusIndex && i < $('.link').length - 1) {
          $('.link').eq(i + 1).focus();
        }
      }
    } else {
      $('.link').eq(0).focus();
    }
  }

<% else %>
<% end %>
